{% load staticfiles %}

{% include "includes/head.html" %}
{% include "includes/header.html" %}

<main>

	<div class="container-fluid">
		<div class="row">
			<div class="col-md-3 col-sm-3" id="topics-container">
				<div class="list-group affix-pre" id="topics" data-clampedwidth="#topics-container">
					<a class="list-group-item active">
						<h4 class="list-group-item-heading">Trending Events</h4>
						<!-- <p class="list-group-item-text">48,283 conversations</p> -->
					</a>
					<a href="#" class="list-group-item list-group-item-success">
						<h4 class="list-group-item-heading">Baltimore Uprising</h4>
						<p class="list-group-item-text">48,283 conversations</p>
					</a>
					<a href="#" class="list-group-item">
						<h4 class="list-group-item-heading">Ferguson Protests</h4>
						<p class="list-group-item-text">39,482 conversations</p>
					</a>
					<a href="#" class="list-group-item">
						<h4 class="list-group-item-heading">Stand With Leah</h4>
						<p class="list-group-item-text">30,282 conversations</p>
					</a>
				</div>
			</div>

			<div class="col-md-9 col-sm-9">
				<div class="row">
					<div class="col-md-6 col-sm-6">
						<h3 class="no-margin-top">Baltimore Uprising</h3>
						<h5>April 18, 2015 â€“ May 3, 2015</h5>
					</div>
					<div class="col-md-6 col-sm-6">
                        <!-- <div class="panel panel-primary"> -->
							<!-- <div class="panel-body"> -->
                                <a class="btn btn-primary margin-bottom" href="{% url 'posts:create' %}">Create New Post</a>
                                <a class="btn btn-primary margin-bottom" href="board">Photo & Video Board</a>
                                <form action="{% url 'posts:search' %}" method="post" >
                                	<div class="form-group">
								        {% csrf_token %}
								        {{ form }}
								        <input class="btn btn-default" type="submit" value="Search"/>
								    </div>
							    </form>
                                <!-- <br/>
                                <div class="pagination">
                                    <span class="step-links">
                                        {% if latest_post_list.has_previous %}
                                            <a href="?page={{ latest_post_list.previous_page_number }}">previous</a>
                                        {% endif %}

                                        <span class="current">
                                            - {{ latest_post_list.number }} of {{ latest_post_list.paginator.num_pages }} - 
                                        </span>

                                        {% if latest_post_list.has_next %}
                                            <a href="?page={{ latest_post_list.next_page_number }}">next</a>
                                        {% endif %}
                                        (Currently displays 5 posts at a time. Can change this in views.py)
                                    </span>
                                </div> -->
                            <!-- </div> -->
                        <!-- </div> -->
                    </div>
                </div> 
                <div class="row">
                    {% if grouped_posts %}

                    	{% for date in sorted_dates %}
                    	<div class="col-md-12 col-sm-12">
                    		<div class="panel panel-primary post-group">
                    			<div class="panel-heading" role="tab" id="h{{ date|date_to_integer:date }}">
                    				<h4 class="panel-title">
                    					<a role="button" data-toggle="collapse" href="#{{ date|date_to_integer:date }}" aria-expanded="false" aria-controls="{{ date|date_to_integer:date }}">
                    						{{ date }}
                    					</a>
                    					<a role="button" data-toggle="collapse" href="#freq{{ date|date_to_integer:date }}" aria-expanded="true" aria-controls="freq{{ date|date_to_integer:date }}" class="pull-right thin-text">
                    						Tag Frequencies
                    					</a>
                    				</h4>
                    			</div> 
                    			<div id="{{ date|date_to_integer:date }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="h{{ date|date_to_integer:date }}">
                    				<div class="panel-body" id="freq{{ date|date_to_integer:date }}" class="panel-collapse collapse in">
                    					{% for tag in tag_freq|get_value:date %}
	                    				<div class="progress">
	                    					<div class="progress-bar" role="progressbar" aria-valuenow="{{ tag_freq|get_value:date|get_value:tag }}" aria-valuemin="0" aria-valuemax="5" style="width: {% widthratio tag_freq|get_value:date|get_value:tag 1 20 %}%">
	                    						{{ tag }} {{ tag_freq|get_value:date|get_value:tag }}
	                    					</div>
	                    				</div>
	                    				<!-- <div> {{ tag }} </div>
	                    				<div> {{ tag_freq|get_value:date|get_value:tag }}</div> -->
	                    				{% endfor %}
	                    			</div>
                    				<div class="panel-body">
                    					{% if date|date_to_integer:date == 20154028 %}
										<div class="col-md-12 col-sm-12">
											<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Freddie Gray&#39;s arrest record(That we just typed up on Microsoft Word even though none of these are probably true): <a href="http://t.co/bOKlIouKgY">pic.twitter.com/bOKlIouKgY</a></p>&mdash; Gurjinder Da Flippa (@gsandhu92) <a href="https://twitter.com/gsandhu92/status/593202454776381441">April 28, 2015</a></blockquote>
										</div>
										<div class="col-md-12 col-sm-12">
											<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Baltimore Tuesday ... <a href="https://twitter.com/hashtag/BaltimoreUprising?src=hash">#BaltimoreUprising</a> <a href="https://twitter.com/hashtag/FreddieGray?src=hash">#FreddieGray</a> <a href="http://t.co/3xXeU6Pf5C">pic.twitter.com/3xXeU6Pf5C</a></p>&mdash; jim spellman (@jimspellmanTV) <a href="https://twitter.com/jimspellmanTV/status/593201913916698624">April 28, 2015</a></blockquote>
											<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
                    					</div>
                    					{% endif %}
                    					{% if date|date_to_integer:date == 20154029 %}
										<div class="col-md-12 col-sm-12">
											<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Arrests at <a href="https://twitter.com/hashtag/FreddieGray?src=hash">#FreddieGray</a> protest in New York. Worth noting &quot;Philly is Baltimore&quot; rally sched 4:30 tmrw in Center City <a href="http://t.co/rK88TvLCa6">pic.twitter.com/rK88TvLCa6</a></p>&mdash; Randy Gyllenhaal (@RandyGyllenhaal) <a href="https://twitter.com/RandyGyllenhaal/status/593565298906820610">April 29, 2015</a></blockquote>
											
										</div>
										<div class="col-md-12 col-sm-12">
											<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Peaceful protest in solidarity with <a href="https://twitter.com/hashtag/FreddieGray?src=hash">#FreddieGray</a> in downtown DC <a href="https://twitter.com/hashtag/DCFerguson?src=hash">#DCFerguson</a> <a href="http://t.co/fsoi3P3Kdl">pic.twitter.com/fsoi3P3Kdl</a></p>&mdash; Alex Zielinski (@alex_zee) <a href="https://twitter.com/alex_zee/status/593565288991498240">April 29, 2015</a></blockquote>
											
                    					</div>
                    					{% endif %}
                    					{% for post in grouped_posts|get_value:date %}
			                    		<div class="col-md-12 col-sm-12">
											<div class="panel panel-default">
												<!-- <div class="panel-heading clearfix">
													<h3 class="panel-title pull-left">{{ post.title }}</h3>
				                                    <span class="pull-right">Event Date: {{ post.event_date }} | Submission Date: {{ post.sub_date }} | Location: {{ post.location }}</span>
												</div> -->
												<div class="panel-body">
													<h3>{{ post.title }}</h3>
													<p>{{ post.text }}</p>

													{% if post.get_post_type_display == 'Photo Post' %}
								                        {% if post.photo.url %}
								                        <img class="img-responsive" src="{{ post.photo.url }}" />
								                        {% endif %}
								                    {% else %}
								                        {% if post.url %}
								                        <iframe src="{{ post.url }}" frameborder="0" allowfullscreen></iframe>
								                        {% endif %}
								                    {% endif %}

													{% if tag_map|get_value:post.id %}
														Tags: 
														{% for tag in tag_map|get_value:post.id %}
															<div class="unvoted-tag update-tag" value="{{ tag.title }}" post-id="{{ post.id }}">{{ tag.title }}
							                                (<div class="update-tag-votes">{{ tag.votes }}</div>)
							                            </div>
														{% endfor %}
													{% endif %}

													{% if post.url %}
													<p>
														<a href="{{ post.url }}">External Link</a>
													</p> 
													{% endif %}
												</div>
												<div class="panel-footer clearfix">
													<span class="pull-left small">
														<i class="fa fa-clock-o"></i> {{ post.event_date }} | <i class="fa fa-map-marker"></i> {{ post.location }}
														<!-- {{ post.get_post_type_display }} -->
														<!-- Event Date: {{ post.event_date }} | Submission Date: {{ post.sub_date }} -->
													</span> 
													<span class="pull-right small">
														<i class="fa fa-link"></i> <a href="{{ post.get_absolute_url }}">Permalink</a>
													</span> 
												</div> 
											</div>
										</div>

			                    		{% endfor %}
			                    		{% if date|date_to_integer:date == 20154028 %}
                    					<div class="col-md-12 col-sm-12">
                    						<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Got a convoy heading towards Druid hill park <a href="https://twitter.com/hashtag/Baltimore?src=hash">#Baltimore</a> <a href="https://twitter.com/hashtag/FreddieGray?src=hash">#FreddieGray</a> <a href="http://t.co/FIMFahJl0T">pic.twitter.com/FIMFahJl0T</a></p>&mdash; QuinnLester (@QuinnLester) <a href="https://twitter.com/QuinnLester/status/593202758469169152">April 28, 2015</a></blockquote>
										</div>
                    					{% endif %}
                    					{% if date|date_to_integer:date == 20154029 %}
                    					<div class="col-md-12 col-sm-12">
                    						<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Solidarity with <a href="https://twitter.com/hashtag/Baltimore?src=hash">#Baltimore</a> from ABQ, New Mexico. <a href="https://twitter.com/hashtag/FreddieGray?src=hash">#FreddieGray</a> <a href="http://t.co/mpWvyJqFxc">pic.twitter.com/mpWvyJqFxc</a></p>&mdash; mayita (@papaya__maya) <a href="https://twitter.com/papaya__maya/status/593565287976316928">April 29, 2015</a></blockquote>
										</div>
                    					{% endif %}
                    				</div> 
                    			</div> 
                    		</div> 
                    	</div>
                    	{% endfor %}

                    {% else %}
                    <div class="col-md-12 col-sm-12">
						<h3>No posts available</h3>
					</div>
					{% endif %}
					
				</div>
			</div>
		</div>
	</div>
</main>

{% include "includes/tags.html" %}
<script src="{% static "js/affix.custom.js" %}"></script>
